---
- name: Restrict permissions on inventory/host_vars directory
  file:
    path: /home/khoe/ansible/inventory/host_vars
    mode: 0700
    state: directory

- name: Restrict permissions on inventory/host_vars files
  shell: chmod 0600 /home/khoe/ansible/inventory/host_vars/*
  args:
    warn: no

- name: 'Set UID min to {{ uid_min }}'
  lineinfile:
    dest: /etc/login.defs
    regexp: '^UID_MIN'
    line: 'UID_MIN			 {{ uid_min }}'
  become: yes

- name: 'Set GID min to {{ gid_min }}'
  lineinfile:
    dest: /etc/login.defs
    regexp: '^GID_MIN'
    line: 'GID_MIN			 {{ gid_min }}'
  become: yes

- name: 'Ensure group "{{ khoe_users_group }}" exists'
  group:
    name: "{{ khoe_users_group }}"
  become: yes

# Prevent ureadahead from filling up syslog
# https://askubuntu.com/questions/749224/92-of-syslog-is-filled-with-message-regarding-ureadahead-ignoring-relative-pa
- name: Remove "ureadahead" package
  apt:
    name: ureadahead
    state: absent
    purge: yes
  become: yes

- name: 'Add (cron) job "start_nas" to khoe''s crontab'
  cron:
    name: 'khoe-boot'
    job: 'cd ansible && ansible-playbook playbooks/boot.yml'
    user: khoe
    state: present
    special_time: reboot

# - import_role:
#     name: common
#     tasks_from: install-config
#   vars:
#     file: khoe.yml
